import{r as t,s as e,c as a,a as o,d as s,u as i}from"./index-c024a321.js";import{u as c,I as n,f as d,E as m,Q as r}from"./vendor-14dfef14.js";function v(){const v=c(),u=n(!1),l=d((()=>e.state.vote.list)),g=d((()=>e.state.vote.pager)),y=d((()=>e.state.vote.currentVoteDetail)),p=async t=>{u.value=!0;try{const a=await o(t);return 200==a.code&&await e.dispatch("vote/setCurrentVoteDetail",a.data),a.data}catch(a){}finally{u.value=!1}};return{setVotes:async t=>{await e.dispatch("vote/setVotes",t)},makeVote:async t=>{u.value=!0;try{const e=await a(t);200==e.code&&(m({title:"成功",message:"创建投票问卷",type:"success"}),await p(e.data.id),v.push(`/vote/edit/${e.data.id}`))}catch(e){r.error(e.message)}finally{u.value=!1}},getVoteDetail:p,updateVote:async(t,a)=>{u.value=!0,e.commit("vote/setLoading",!0);try{const o=await i(t,a);200==o.code?(e.commit("vote/setLoading",!1),u.value=!1):(r.error(o.message),u.value=!1,e.commit("vote/setLoading",!1))}catch(o){u.value=!1,e.commit("vote/setLoading",!1)}},deleteVote:async t=>{u.value=!0,e.commit("vote/setLoading",!0);try{const a=await s(t);200==a.code?m({title:"成功",message:"删除投票问卷",type:"success"}):r.error(a.message)}catch(a){}finally{u.value=!1,e.commit("vote/setLoading",!1)}},updateVoteForAddOption:async a=>{u.value=!0,e.commit("vote/setLoading",!0);try{const o=await(async e=>await t("option/create",{method:"POST",data:e}))(a);if(200==o.code)return u.value=!1,e.commit("vote/setLoading",!1),o.data;r.error(o.message),u.value=!1,e.commit("vote/setLoading",!1)}catch(o){u.value=!1,e.commit("vote/setLoading",!1)}},updateVoteForDelOption:async a=>{u.value=!0,e.commit("vote/setLoading",!0);try{const o=await(async e=>await t(`option/${e}`,{method:"DELETE"}))(a);200==o.code||r.error(o.message),u.value=!1,e.commit("vote/setLoading",!1)}catch(o){u.value=!1,e.commit("vote/setLoading",!1)}},updateVoteForUptOption:async(a,o)=>{u.value=!0,e.commit("vote/setLoading",!0);try{const s=await(async(e,a)=>await t(`option/${e}`,{method:"PUT",data:a}))(a,{name:o});200==s.code||r.error(s.message),u.value=!1,e.commit("vote/setLoading",!1)}catch(s){u.value=!1,e.commit("vote/setLoading",!1)}},votes:l,pager:g,loading:u,curVoteDetail:y}}export{v as u};
