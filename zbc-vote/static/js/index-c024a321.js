var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,i=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&s(e,a,t[a]);if(o)for(var a of o(t))n.call(t,a)&&s(e,a,t[a]);return e};import{r as c,o as d,c as l,l as m,a as u,b as p,N as h,E as y,V as f,d as g}from"./vendor-14dfef14.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const v={};v.render=function(e,t){const a=c("router-view");return d(),l(a)};const w=(e,t)=>{window.sessionStorage.setItem(e,JSON.stringify(t)||"")},_=e=>JSON.parse(window.sessionStorage.getItem(e)),E=()=>_("token"),P=e=>{w("token",e)},b=()=>{var e;e="token",window.sessionStorage.removeItem(e)},O=async(e,t)=>{var a=t,{data:s,token:c,headers:d}=a,l=((e,t)=>{var a={};for(var s in e)r.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&o)for(var s of o(e))t.indexOf(s)<0&&n.call(e,s)&&(a[s]=e[s]);return a})(a,["data","token","headers"]);const u=i({method:"GET",headers:{Authorization:c?`Bearer ${c}`:"","Content-Type":s?"application/json":""}},l);return"GET"===u.method.toUpperCase()?e+=`?${m.stringify(s)}`:u.body=JSON.stringify(s||{}),window.fetch(`http://47.106.210.214:8080/${e}`,u).then((async e=>{if(401===e.status)return window.location.reload(),Promise.reject(new Error("请重新登录"));const t=await e.json();return e.ok?t:Promise.reject(t)}))},L=async(e,o={method:"GET",data:""})=>{const r=E();var n,s;return await O(e,(n=i({},o),s={token:r},t(n,a(s))))},k=async e=>await O("user/login",{data:e,method:"POST"}),j=async e=>await O("user/register",{data:e,method:"POST"}),T={},C=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`/zbc-vote/${e}`)in T)return;T[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),t?new Promise(((e,t)=>{o.addEventListener("load",e),o.addEventListener("error",t)})):void 0}))).then((()=>e())):e()},D=[{path:"/",redirect:"/home"},{path:"/home",name:"home",component:()=>C((()=>import("./index-1e35c4c4.js")),["static/js/index-1e35c4c4.js","static/css/index-36938ec0.css","static/js/vendor-14dfef14.js","static/js/auth-d0a18506.js","static/js/vote-9bc7bf17.js"])},{path:"/vote",name:"vote",component:()=>C((()=>import("./index-520b45ab.js")),["static/js/index-520b45ab.js","static/css/index-3260730d.css","static/js/vendor-14dfef14.js","static/js/vote-9bc7bf17.js"]),children:[{path:"/vote/edit/:id",name:"voteEdit",component:()=>C((()=>import("./edit-08a9ba9c.js")),["static/js/edit-08a9ba9c.js","static/css/edit-6cb4413d.css","static/js/vendor-14dfef14.js","static/js/vote-9bc7bf17.js","static/js/index-f917b9a7.js"]),meta:{isShow:!0}},{path:"/vote/publish/:id",name:"votePublish",component:()=>C((()=>import("./publish-ef84afee.js")),["static/js/publish-ef84afee.js","static/css/publish-5b183cb7.css","static/js/vendor-14dfef14.js","static/js/vote-9bc7bf17.js"]),meta:{isPreview:!0}},{path:"/vote/report/:id",name:"voteReport",component:()=>C((()=>import("./report-9d8e080c.js")),["static/js/report-9d8e080c.js","static/css/report-fe1108ed.css","static/js/vendor-14dfef14.js"])}]},{path:"/survey/:id",name:"survey",component:()=>C((()=>import("./index-c0fc60fe.js")),["static/js/index-c0fc60fe.js","static/css/index-81a5bcfd.css","static/js/vendor-14dfef14.js","static/js/index-f917b9a7.js"])},{path:"/auth",name:"auth",component:()=>C((()=>import("./index-46aab6f7.js")),["static/js/index-46aab6f7.js","static/css/index-6221ce02.css","static/js/auth-d0a18506.js","static/js/vendor-14dfef14.js"])},{path:"/:catchAll(.*)",name:"404",component:()=>C((()=>import("./Page404-c9dc73c6.js")),["static/js/Page404-c9dc73c6.js","static/css/Page404-2ea88b5a.css","static/js/vendor-14dfef14.js"])}];const S=u({history:p(),routes:D});S.beforeEach((async(e,t,a)=>{h.start();const o=await E();"/auth"===e.path?o?a("/home"):a():"survey"===e.name?a():null==o||""===o?a("/auth"):"/auth"===e.path?a("/home"):a()})),S.afterEach((()=>{h.done()}));const V={namespaced:!0,state:()=>({token:E()||""}),mutations:{setUser(e,t){e.token=t},clearUser(e){b(),e.token=""}},actions:{async setUser({commit:e},t){e("setUser",t)},async clearUser({commit:e}){200==(await(async()=>await L("user/logout",{method:"POST"}))()).code?(y({title:"提示",message:"用户已退出登陆！",type:"success",duration:2e3}),await e("clearUser"),S.replace("/auth")):y({title:"提示",message:"用户退出登陆失败！",type:"error",duration:2e3})}}},I=async e=>await L("question/create",{method:"POST",data:e}),x=async e=>await L(`question/${e}`),A=async(e,t)=>await L(`question/${e}`,{method:"PUT",data:t}),$=async e=>await L(`question/${e}`,{method:"DELETE"}),N=async e=>await(async(e,t="")=>(t&&(e+=`?${m.stringify(t)}`),await fetch(e,{method:"GET"}).then((async e=>{const t=await e.json();return e.ok?t:Promise.reject(t)}))))(`http://47.106.210.214:8080/question/detail/${e}`),R=async e=>O("record/create",{method:"POST",data:e}),U={namespaced:!0,state:()=>({list:[],pager:{pages:1,total:0},currentVoteDetail:_("currentVoteDetail")||{},loading:!1}),mutations:{setList(e,t){e.list=t},setPager(e,t){e.pager=t},setCurrentVoteDetail(e,t){e.currentVoteDetail=t},setLoading(e,t){e.loading=t}},actions:{async setVotes({commit:e},t){try{const a=await(async e=>await L("question/list/currentUser",{data:{pageNum:e,pageSize:7}}))(t);200==a.code&&(e("setList",a.data.records),e("setPager",{pages:a.data.pages,total:a.data.total}))}catch(a){}},async setCurrentVoteDetail({commit:e},t){e("setCurrentVoteDetail",t),w("currentVoteDetail",t)}}},q={checkList:_("checkList")||[]};var z=new f.Store({state:q,mutations:{setCheckList(e,t){e.checkList=t}},actions:{async getCheckList({commit:e}){try{const a=await(async()=>await L("check/listAll"))();200==a.code&&(t=a.data,w("checkList",t),e("setCheckList",a.data))}catch(a){}var t}},modules:{user:V,vote:U}});const G=g(v);G.config.globalProperties.$ELEMENT={size:"small",zIndex:3e3},G.use(z).use(S),G.mount("#app"),G.directive("copy",{beforeMount(e,t){e.targetContent=t.value;const a=t.arg;e.addEventListener("click",(()=>{if(!e.targetContent)return;const t=document.createElement("textarea");t.readOnly="readonly",t.style.position="fixed",t.style.top="-99999px",t.value=e.targetContent,document.body.appendChild(t),t.select();document.execCommand("Copy")&&a&&a(e.targetContent),document.body.removeChild(t)}))},updated(e,t){e.targetContent=t.value},unmounted(e){e.removeEventListener("click",(()=>{}))}});export{x as a,P as b,I as c,$ as d,j as e,S as f,E as g,N as h,k as l,R as p,L as r,z as s,A as u};
